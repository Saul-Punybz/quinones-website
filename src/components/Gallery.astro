---
const images = [
  { src: 'https://images.unsplash.com/photo-1632759145351-1d592919f522?auto=format&fit=crop&w=600&q=80', alt: 'Sellado de techo', span: 'row-span-2' },
  { src: 'https://images.unsplash.com/photo-1585128792020-803d29415281?auto=format&fit=crop&w=600&q=80', alt: 'Instalación de losetas', span: '' },
  { src: 'https://images.unsplash.com/photo-1562259929-b4e1fd3aef09?auto=format&fit=crop&w=600&q=80', alt: 'Pintura de interiores', span: '' },
  { src: 'https://images.unsplash.com/photo-1584622650111-993a426fbf0a?auto=format&fit=crop&w=600&q=80', alt: 'Remodelación de baño', span: 'row-span-2' },
  { src: 'https://images.unsplash.com/photo-1581094794329-c8112a89af12?auto=format&fit=crop&w=600&q=80', alt: 'Trabajo de plomería', span: '' },
  { src: 'https://images.unsplash.com/photo-1504307651254-35680f356dfd?auto=format&fit=crop&w=600&q=80', alt: 'Construcción general', span: '' },
  { src: 'https://images.unsplash.com/photo-1523413363574-c30aa1c2a516?auto=format&fit=crop&w=600&q=80', alt: 'Trabajo eléctrico', span: '' },
  { src: 'https://images.unsplash.com/photo-1613545325278-f24b0cae1224?auto=format&fit=crop&w=600&q=80', alt: 'Acabado de hogar', span: '' },
];
---

<section id="galeria" class="py-20 bg-fondo">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-16">
      <h2 class="text-3xl sm:text-4xl md:text-5xl font-bold text-cafe mb-4">
        Nuestros Trabajos
      </h2>
      <div class="w-20 h-1 bg-terracota mx-auto rounded-full"></div>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 auto-rows-[200px]">
      {images.map((img) => (
        <div class={`gallery-item cursor-pointer overflow-hidden rounded-xl group ${img.span}`}>
          <img
            src={img.src}
            alt={img.alt}
            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"
            loading="lazy"
          />
        </div>
      ))}
    </div>
  </div>

  <!-- Lightbox -->
  <div id="lightbox" class="fixed inset-0 z-[100] bg-black/90 hidden items-center justify-center p-4">
    <button id="lightbox-close" class="absolute top-6 right-6 text-white hover:text-terracota transition-colors" aria-label="Cerrar">
      <svg class="w-10 h-10" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
      </svg>
    </button>
    <img id="lightbox-img" src="" alt="" class="max-w-full max-h-[90vh] rounded-lg shadow-2xl" />
  </div>
</section>

<script>
  const lightbox = document.getElementById('lightbox');
  const lightboxImg = document.getElementById('lightbox-img') as HTMLImageElement;
  const lightboxClose = document.getElementById('lightbox-close');

  document.querySelectorAll('.gallery-item').forEach(item => {
    item.addEventListener('click', () => {
      const img = item.querySelector('img') as HTMLImageElement;
      if (img && lightboxImg && lightbox) {
        lightboxImg.src = img.src.replace('w=600', 'w=1200');
        lightboxImg.alt = img.alt;
        lightbox.classList.remove('hidden');
        lightbox.classList.add('flex');
      }
    });
  });

  lightboxClose?.addEventListener('click', () => {
    lightbox?.classList.add('hidden');
    lightbox?.classList.remove('flex');
  });

  lightbox?.addEventListener('click', (e) => {
    if (e.target === lightbox) {
      lightbox.classList.add('hidden');
      lightbox.classList.remove('flex');
    }
  });

  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      lightbox?.classList.add('hidden');
      lightbox?.classList.remove('flex');
    }
  });
</script>
